variant7/stage1/emulator.py
#!/usr/bin/env python3
"""
Этап 1: REPL для эмулятора командной строки
Вариант 7
"""

import os
import re
import sys

def expand_env_vars(text):
    """Раскрывает переменные окружения, например $HOME"""
    return re.sub(r'\$(\w+)', lambda m: os.getenv(m.group(1), ''), text)

def main():
    print("=== Эмулятор командной строки (Вариант 7) ===")
    print("Введите команды. Для выхода введите 'exit'")
    print("=" * 50)
    
    vfs_name = "myvfs"
    hostname = "localhost"
    user = "student"
    
    while True:
        prompt = f"{user}@{hostname}:{vfs_name}$ "
        
        try:
            cmd_line = input(prompt).strip()
            if not cmd_line:
                continue
                
            cmd_line = expand_env_vars(cmd_line)
            parts = cmd_line.split()
            cmd = parts[0]
            args = parts[1:] if len(parts) > 1 else []
            
            if cmd == "exit":
                print("Выход из эмулятора.")
                break
                
            elif cmd == "ls":
                print(f"Команда 'ls': аргументы = {args}")
                print("(Это заглушка. На реальной файловой системе здесь был бы список файлов)")
                
            elif cmd == "cd":
                print(f"Команда 'cd': аргументы = {args}")
                if args:
                    print(f"(Переходим в директорию: {args[0]})")
                else:
                    print("(Ошибка: укажите путь)")
                    
            elif cmd == "help":
                print("Доступные команды:")
                print("  ls       - список файлов (заглушка)")
                print("  cd <dir> - сменить директорию (заглушка)")
                print("  exit     - выйти из эмулятора")
                print("  help     - эта справка")
                
            else:
                print(f"Ошибка: неизвестная команда '{cmd}'")
                print("Введите 'help' для списка команд")
                
        except KeyboardInterrupt:
            print("\nПрервано пользователем.")
            break
        except Exception as e:
            print(f"Ошибка выполнения: {e}")

if __name__ == "__main__":
    main()
